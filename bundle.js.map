{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://webpack--js.basic.09.2022/./src/getInput.js","webpack://webpack--js.basic.09.2022/./src/addHistory.js","webpack://webpack--js.basic.09.2022/./src/firstLoad.js","webpack://webpack--js.basic.09.2022/./src/index.js"],"sourcesContent":["/*\nФункци addLi принимает строковый параметр - название города, и в зависимости от истории\nзапросов пользователя добавляет в ul>li данный город. Количество запросов в истории не может \nбыть больше 10, функция удаляет первый из списка, если запросов больше.\nВозвращает массив Li.\n------\nФункция resetResult(dataWeather) принимает данные о погоде, и по этим данным меняет содержание на странице\nназвание города, температуры, иконку погода, и карту местности. В случаве не корректного запроса, выводит сообщение \nо ошибке. Возвращает текстовую информацию о городе или об ошибке.\n------\nФункция getInput добавляет функционал к кнопке на форме\n\n*/\n\nimport { addHistory } from './addHistory';\nimport { getWeather } from './firstLoad';\n\nfunction addLi(str) {\n    const arrli = document.querySelectorAll('li');\n    let count = 0;\n    //проверяем есть ли повторения в списке\n    arrli.forEach((element) => {\n        if (element.textContent === str) {\n            count += 1;\n        }\n    });\n    //если повторений нет - то добаввляем в список\n    if (count === 0) {\n        if (arrli.length > 9) {\n            arrli[0].remove(); //удаляем первый из списка\n        }\n        //let ul = document.querySelector('.history__ul');\n        const li = document.createElement('li');\n        li.innerText = str;\n        li.addEventListener('click', async () => {\n            const dataWeather = await getWeather(li.textContent);\n            resetResult(dataWeather);\n        });\n        document.querySelector('.history__ul').appendChild(li);\n    }\n    return arrli;\n}\nexport { addLi };\n\nfunction resetResult(dataWeather) {\n    const cityName = document.querySelector('.cityName');\n    const cityTemp = document.querySelector('.cityTemp');\n    const imgIcon = document.querySelector('.icon');\n    const img = document.querySelector('.content__map_img');\n    if (dataWeather.cod === '404' || dataWeather.cod === '400') {\n        cityName.innerText = 'Введите повторно - нет такого города в базе';\n        cityTemp.innerText = '';\n        imgIcon.style.display = 'none';\n        img.setAttribute(\n            'src',\n            `https://avatars.mds.yandex.net/i?id=8b74ba27269a7cf022fefea25f692daef9623322-4340501-images-thumbs&n=13`\n        );\n        return 'Введите повторно - нет такого города в базе';\n    } else {\n        cityName.innerText = `Город: ${dataWeather.name}`;\n        cityTemp.innerText = `Температура в городе: ${Math.ceil(\n            dataWeather.main.temp - 273.15\n        )}°C`;\n        imgIcon.style.display = 'inline';\n        imgIcon.setAttribute(\n            'src',\n            `http://openweathermap.org/img/wn/${dataWeather.weather[0]['icon']}.png`\n        );\n        img.setAttribute(\n            'src',\n            `https://static-maps.yandex.ru/1.x/?ll=${dataWeather.coord.lon},${dataWeather.coord.lat}8&size=400,300&amp&spn=2,2&l=map`\n        );\n        addHistory(dataWeather.name);\n        addLi(dataWeather.name);\n        return `Город: ${dataWeather.name}`;\n    }\n}\nexport { resetResult };\n\nfunction getInput() {\n    const form = document.querySelector('.search__form');\n    form.addEventListener('submit', async (form1) => {\n        form1.preventDefault();\n        const str = document.querySelector('.search__form_input').value;\n        const dataWeather = await getWeather(str);\n        resetResult(dataWeather);\n        document.querySelector('.search__form_input').value = '';\n    });\n}\nexport { getInput };\n","/*\nФункци addHistory принимает строковый параметр - название города, и в зависимости от истории\nзапросов пользователя добавляет в local storage данный город. Количество запросов в истории не может \nбыть больше 10, функция удаляет первый из масссива, если запросов больше.\nВозвращает массив запросов.\n\n*/\n\nexport function addHistory(str) {\n    const arrHistory = JSON.parse(localStorage.getItem('history'));\n    let history = arrHistory === null ? [] : [...arrHistory];\n    if (!history.includes(str)) {\n        // проверяем количество записей в истории\n        history = history.length >= 10 ? (history = history.slice(1)) : history;\n        history.push(str);\n        localStorage.setItem('history', JSON.stringify(history));\n        return history;\n    } else {\n        return history;\n    }\n}\n","/*\nФункци getGeo определяет местоположение пользователя \nи возвращает данные с геопозицией( координаты, название города)\n-----\nФункция getWeather принимает строковый параметр - название города и возвращает объект с данными о погоде\nв данном городе\n-----\nФункция createPage принимает объект с данными о погоде и выводит температуру, \nназвание города, иконку погоды на страницу. А также с использование static-maps\nпоказывает карту города.\n-----\nФункция firstLoad в зависимости от истории запросов, вызывает функции либо начальной загрузки приложения, \nлибо по последнему запросу пользователя\n*/\n\nimport { getInput } from './getInput';\n\nasync function getGeo() {\n    try {\n        const result = await fetch('https://get.geojs.io/v1/ip/geo.json');\n        const data = await result.json();\n        return data;\n    } catch (err) {\n        return null;\n    }\n}\nasync function getWeather(city) {\n    try {\n        const getWeath = await fetch(\n            `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=9131f66cd3745fc87830ad367b122a9c`\n        );\n        const weather = await getWeath.json();\n        return weather;\n    } catch (err) {\n        return null;\n    }\n}\nexport { getWeather };\n\nexport function createPage(weatherCity) {\n    const content__result = document.querySelector('.content__result');\n    const cityName = document.createElement('p');\n    const cityTemp = document.createElement('p');\n    const imgIcon = document.createElement('img');\n    cityName.setAttribute('class', 'cityName');\n    cityTemp.setAttribute('class', 'cityTemp');\n    imgIcon.setAttribute('class', 'icon');\n    imgIcon.setAttribute(\n        'src',\n        `http://openweathermap.org/img/wn/${weatherCity.weather[0]['icon']}.png`\n    );\n    content__result.appendChild(cityName);\n    content__result.appendChild(cityTemp);\n    content__result.appendChild(imgIcon);\n    cityName.innerText = `Ваш город ${weatherCity.name}`;\n    cityTemp.innerText = `Температура в городе: ${Math.ceil(\n        weatherCity.main.temp - 273.15\n    )}°C`;\n    const map = document.querySelector('.content__map');\n    const img = document.createElement('img');\n    map.appendChild(img);\n    img.setAttribute('class', 'content__map_img');\n    img.setAttribute(\n        'src',\n        `https://static-maps.yandex.ru/1.x/?ll=${weatherCity.coord['lon']},${weatherCity.coord['lat']}&size=400,300&amp&spn=2,2&l=map`\n    );\n    return img.getAttribute('src');\n}\n\nasync function firstLoad() {\n    const localHistory = JSON.parse(localStorage.getItem('history'));\n    if (localHistory === null) {\n        const resultCity = await getGeo();\n        const dataWeather = await getWeather(resultCity.city);\n        createPage(dataWeather);\n    } else {\n        const resultCity = localHistory.at(-1);\n        const dataWeather = await getWeather(resultCity);\n        createPage(dataWeather);\n    }\n    getInput();\n}\n\nexport { firstLoad };\n","import '../css/style.css';\nimport { firstLoad } from './firstLoad';\n\nfirstLoad();\n"],"names":["resetResult","dataWeather","str","arrHistory","history","cityName","document","querySelector","cityTemp","imgIcon","img","cod","innerText","style","display","setAttribute","name","Math","ceil","main","temp","weather","coord","lon","lat","JSON","parse","localStorage","getItem","includes","length","slice","push","setItem","stringify","arrli","querySelectorAll","count","forEach","element","textContent","remove","li","createElement","addEventListener","getWeather","appendChild","addLi","getInput","form1","preventDefault","value","getGeo","fetch","result","json","data","city","getWeath","createPage","weatherCity","content__result","map","getAttribute","localHistory","resultCity","at","firstLoad"],"sourceRoot":""}