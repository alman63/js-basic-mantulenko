{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://webpack--js.basic.09.2022/./src/addHistory.js","webpack://webpack--js.basic.09.2022/./src/getInput.js","webpack://webpack--js.basic.09.2022/./src/firstLoad.js","webpack://webpack--js.basic.09.2022/./src/index.js"],"sourcesContent":["import { resetResult } from './getInput';\n\nexport function addHistory(str) {\n    let arrHistory = JSON.parse(localStorage.getItem('history'));\n    let history = arrHistory === null ? [] : [...arrHistory];\n    if (!history.includes(str)) {\n        // проверяем количество записей в истории\n        if (history.length >= 10) {\n            history = history.slice(1);\n            document.querySelectorAll('li')[0].remove();\n        }\n        history.push(str);\n        localStorage.setItem('history', JSON.stringify(history));\n    }\n}\n","import { addHistory } from './addHistory';\nimport { getWeather } from './firstLoad';\n\nasync function resetResult(city) {\n    const dataWeather = await getWeather(city);\n    const cityName = document.querySelector('.cityName');\n    const cityTemp = document.querySelector('.cityTemp');\n    const imgIcon = document.querySelector('.icon');\n    const img = document.querySelector('.content__map_img');\n    if (dataWeather.cod == '404') {\n        cityName.innerText = `Введите повторно - нет такого города в базе`;\n        cityTemp.innerText = ``;\n        imgIcon.style.display = 'none';\n        img.setAttribute(\n            'src',\n            `https://avatars.mds.yandex.net/i?id=8b74ba27269a7cf022fefea25f692daef9623322-4340501-images-thumbs&n=13`\n        );\n        return 'Введите повторно - нет такого города в базе';\n    } else {\n        cityName.innerText = `Город: ${dataWeather.name}`;\n        cityTemp.innerText = `Температура в городе: ${Math.ceil(\n            dataWeather.main.temp - 273.15\n        )}°C`;\n        imgIcon.style.display = 'inline';\n        imgIcon.setAttribute(\n            'src',\n            `http://openweathermap.org/img/wn/${dataWeather.weather[0]['icon']}.png`\n        );\n        img.setAttribute(\n            'src',\n            `https://static-maps.yandex.ru/1.x/?ll=${dataWeather.coord.lon},${dataWeather.coord.lat}8&size=400,300&amp&spn=2,2&l=map`\n        );\n        addHistory(dataWeather.name);\n        addLi(dataWeather.name);\n        return `Ваш город ${dataWeather.name}`;\n    }\n}\nexport { resetResult };\n\nfunction addLi(str) {\n    const arrli = document.querySelectorAll('li');\n    let count = 0;\n    arrli.forEach((element) => {\n        if (element.textContent === str) {\n            count += 1;\n        }\n    });\n    console.log(count);\n    if (count === 0) {\n        const ul = document.querySelector('.history__ul');\n        const li = document.createElement('li');\n        li.innerText = str;\n        li.addEventListener('click', () => {\n            resetResult(li.textContent);\n        });\n        ul.appendChild(li);\n    }\n}\n\nexport function getInput() {\n    // const button = document.querySelector('.search__form_buttom');\n    const form = document.querySelector('.search__form');\n    form.addEventListener('submit', (event) => {\n        event.preventDefault();\n        const str = document.querySelector('.search__form_input').value;\n        resetResult(str);\n        document.querySelector('.search__form_input').value = '';\n    });\n}\n","import { getInput } from './getInput';\n\nasync function getGeo() {\n    try {\n        const result = await fetch('https://get.geojs.io/v1/ip/geo.json');\n        const data = await result.json();\n        return data;\n    } catch (err) {\n        return null;\n    }\n}\nasync function getWeather(city) {\n    try {\n        const getWeath = await fetch(\n            `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=9131f66cd3745fc87830ad367b122a9c`\n        );\n        let weather = await getWeath.json();\n        return weather;\n    } catch (err) {\n        return null;\n    }\n}\nexport { getWeather };\n\nasync function createPage(weatherCity) {\n    const content__result = document.querySelector('.content__result');\n    const cityName = document.createElement('p');\n    const cityTemp = document.createElement('p');\n    const imgIcon = document.createElement('img');\n    cityName.setAttribute('class', 'cityName');\n    cityTemp.setAttribute('class', 'cityTemp');\n    imgIcon.setAttribute('class', 'icon');\n    imgIcon.setAttribute(\n        'src',\n        `http://openweathermap.org/img/wn/${weatherCity.weather[0]['icon']}.png`\n    );\n    content__result.appendChild(cityName);\n    content__result.appendChild(cityTemp);\n    content__result.appendChild(imgIcon);\n    cityName.innerText = `Ваш город ${weatherCity.name}`;\n    cityTemp.innerText = `Температура в городе: ${Math.ceil(\n        weatherCity.main.temp - 273.15\n    )}°C`;\n    const map = document.querySelector('.content__map');\n    const img = document.createElement('img');\n    map.appendChild(img);\n    img.setAttribute('class', 'content__map_img');\n    img.setAttribute(\n        'src',\n        `https://static-maps.yandex.ru/1.x/?ll=${weatherCity.coord['lon']},${weatherCity.coord['lat']}&size=400,300&amp&spn=2,2&l=map`\n    );\n}\nasync function firstLoad() {\n    const localHistory = JSON.parse(localStorage.getItem('history'));\n    if (localHistory === null) {\n        let resultCity = await getGeo();\n        let dataWeather = await getWeather(resultCity.city);\n        createPage(dataWeather);\n    } else {\n        let resultCity = localHistory.at(-1);\n        let dataWeather = await getWeather(resultCity);\n        createPage(dataWeather);\n    }\n    getInput();\n}\n\nexport { firstLoad };\n","import '../css/style.css';\n\nimport { firstLoad } from './firstLoad';\n\nfirstLoad();\n"],"names":["addHistory","str","arrHistory","JSON","parse","localStorage","getItem","history","includes","length","slice","document","querySelectorAll","remove","push","setItem","stringify","i","resetResult","city","getWeather","dataWeather","cityName","querySelector","cityTemp","imgIcon","img","cod","innerText","style","display","setAttribute","name","Math","ceil","main","temp","weather","coord","lon","lat","addLi","arrli","count","forEach","element","textContent","console","log","ul","li","createElement","addEventListener","appendChild","getInput","event","preventDefault","value","getGeo","fetch","result","json","data","getWeath","createPage","weatherCity","content__result","map","localHistory","resultCity","at","firstLoad"],"sourceRoot":""}